define(["services/logger","plugins/router","services/session","services/datacontext"],function(e,n,t,r){function o(){return d(p),e.log("Join House View Activated",null,"join-house",!0),u()}function a(){}function i(){return t.logout().then(function(){n.navigate("#login")})}function s(){return r.joinHouse(t.sessionUser,v()).then(u)}function l(){var e=f();return f(null),r.cancelHouseRequest(e).then(u)}function c(){return r.createHouse(t.sessionUser,b(),g()).then(t.refreshSession).then(function(){n.navigate("#home")})}function u(){return r.getUsersJoinRequest(t.sessionUser,f)}function d(e){e("Welcome "+t.sessionUser().FirstName()+"!")}var p=new ko.observable,v=new ko.observable,b=new ko.observable,g=new ko.observable,f=new ko.observable,h={activate:o,title:"Join House",attached:a,pageHeader:p,joinHouseCode:v,createHouseName:b,createHouseCode:g,joinExistingHouseClicked:s,createNewHouseClicked:c,cancelRequestClicked:l,logoutClicked:i,houseJoinRequest:f};return h});