define(["config","services/datacontext","plugins/router"],function(e,t){function n(e,n){return t.login(e,n).then(l)}function r(e){return t.facebookLogin(e).then(l)}function i(e,n,r,i,o){return t.register(e,n,r,i).then(function(e){e.errors&&o(e)}).then(l)}function o(){return t.logout().then(l)}function a(e){return t.changePassword(e)}function s(){return $.ajax({type:"GET",url:"account/refreshtoken"}).then(function(e){$("#__AjaxAntiForgeryForm").html(e)})}function l(){return s().then(function(){return t.getLoggedInUser(c)})}var c=new ko.observable,u={sessionUser:c,refreshSession:l,login:n,facebookLogin:r,logout:o,register:i,changePassword:a};return u});