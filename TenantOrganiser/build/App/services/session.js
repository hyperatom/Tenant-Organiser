define(["config","services/datacontext","plugins/router"],function(e,t){function n(e,n){return t.login(e,n).then(function(){return c()})}function r(e){return t.facebookLogin(e).then(c)}function i(e,n,r,i,o){return t.register(e,n,r,i).then(function(e){e.errors&&o(e)}).then(c)}function o(){return t.logout().then(c)}function a(e){return t.changePassword(e)}function s(e){return t.changeEmail(e)}function l(){return $.ajax({type:"GET",url:"account/refreshtoken"}).then(function(e){$("#__AjaxAntiForgeryForm").html(e)})}function c(){return l().then(function(){return t.getLoggedInUser(u)})}var u=new ko.observable,d={sessionUser:u,refreshSession:c,login:n,facebookLogin:r,logout:o,register:i,changePassword:a,changeEmail:s};return d});