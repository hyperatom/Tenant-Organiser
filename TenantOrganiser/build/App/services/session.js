define(["config","services/datacontext","plugins/router"],function(e,n){function t(e,t){return n.login(e,t).then(s)}function r(e,t,r,o,a){return n.register(e,t,r,o).then(function(e){e.errors&&a(e)}).then(s)}function o(){return n.logout().then(s)}function a(e){return n.changePassword(e)}function i(){return $.ajax({type:"GET",url:"account/refreshtoken"}).then(function(e){$("#__AjaxAntiForgeryForm").html(e)})}function s(){return i().then(function(){return n.getLoggedInUser(l)})}var l=new ko.observable,c={sessionUser:l,refreshSession:s,login:t,logout:o,register:r,changePassword:a};return c});