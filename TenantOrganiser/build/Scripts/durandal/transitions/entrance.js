define(["durandal/system","durandal/composition","jquery"],function(e,n,t){var r=100,o={marginRight:0,marginLeft:0,opacity:1},a={marginLeft:"",marginRight:"",opacity:"",display:""},i=function(n){return e.defer(function(e){function i(){e.resolve()}function s(){n.keepScrollPosition||t(document).scrollTop(0)}function l(){s(),n.triggerAttach();var e={marginLeft:u?"0":"20px",marginRight:u?"0":"-20px",opacity:0,display:"block"},r=t(n.child);r.css(e),r.animate(o,{duration:c,easing:"swing",always:function(){r.css(a),i()}})}if(n.child){var c=n.duration||500,u=!!n.fadeOnly;n.activeView?t(n.activeView).fadeOut({duration:r,always:l}):l()}else t(n.activeView).fadeOut(r,i)}).promise()};return i});